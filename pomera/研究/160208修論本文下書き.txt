160208修論本文下書き

要旨の構成から改良版


1。緒言
1。1。研究背景
1。2。研究目的
2。危険予測運転技術
2。1。最高安全速度
2。2。自動で減速するシステム
3。危険予測自動運転システム
3。1。システム概要
3。2。ポテンシャルフィールド法
3。3。ポテンシャル関数
3。3。1。基本走行ポテンシャル
3。3。2。歩行者ポテンシャル
3。3。3。アクセルポテンシャル
3。4。速度への制御
3。4。1。ダンピング
3。4。2。速度制御
4。シミュレーションによる評価
4。1。シミュレーションの目的
4。2。検証内容と判定のアルゴリズム
4。3。シミュレーション結果
4。4。結果の考察と今後の課題
5。結言
・研究背景
・謝辞
・質疑応答


要旨の構成から改良版


1。緒言
1。1。研究背景
1。2。研究目的
2。危険予測運転技術
2。1。最高安全速度
2。2。自動で減速するシステム
3。危険予測自動運転システム
3。1。システム概要
　安全の確保と交通の円滑さのため、危険予測自動運転技術として、ポテンシャルフィールド法を用いた車両制御手法を提案する。提案する危険予測自動運転車両制御システムの制御ブロック図を図○に示す。以下に制御の流れを記す。
　まず、自車の位置や姿勢、速度と歩行者位置を入力とし、ポテンシャルフィールド法やダンピングにより、斥力や減衰力が算出される。その力を車両が出力出来るように、前後加速度と実操舵角に変換する。変換された値が車両モデルに入力され、次のステップの自車位置、姿勢、速度が決定する。これをフィードバックする。以上のようなシステムになっている。
3。2。ポテンシャルフィールド法
　本論文では、ポテンシャルフィールド法を用いて、最高安全速度を順守しつつ、前方の歩行者を追い越す車両制御するシステムを提案する。ポテンシャルフィールド法とは、図○のように、歩行者や道路境界から仮想的な斥力が発生しているとし、その斥力によってあたかも加速度が生じているかのように車両を制御する手法である。
3。3。ポテンシャル関数
　ポテンシャルフィールドを表す関数をポテンシャル関数と呼ぶ。本論文では、以下のようなポテンシャル関数を用いる。
3。3。1。基本走行ポテンシャル
　前方の歩行者が存在していない場合において、自車が直線単路を走るためのポテンシャルを基本走行ポテンシャルと定義する。以下の○〜○で表され、走行レーンを表すレーンポテンシャルと、左右の道路境界を表す道路境界ポテンシャルで構成される。
　各パラメータは表○に示すように定義され、後述するシミュレーションにおいて、すべての評価基準を満たすように設定する。
　卒業論文時には、左右の道路境界ポテンシャルを、レーンポテンシャルに用いているガウス関数で表現していたため、道幅Wrがへんかしても力が変化せず、道幅が狭い場合には、道路境界から逸脱してしまう場合が確認されている。その問題は、基本走行ポテンシャルにより解決した。
3。3。2。歩行者ポテンシャル
　自車前方に存在する歩行者に設定されているポテンシャルを歩行者ポテンシャルと定義する。式○に示すように、このポテンシャルでは、歩行者に衝突しないように、歩行者に近づけば近づく程、力が大きくなるようなポテンシャルに設定されている。
　各パラメータは、後述するシミュレーションにおいて、すべての条件を満たすように設定する。
　卒業論文時からの変更はない。後述する今後の課題において、現状の歩行者ポテンシャルの課題と、実装に至らなかったアイデアについて述べる。
3。3。3。アクセルポテンシャル
　自車が歩行者ポテンシャルによって、減速し過ぎないため、また、通常巡航速度30km/hに復帰するためのポテンシャルを、アクセルポテンシャルと定義する。
　式○をXで微分し、マイナスを書けると、自車に仮想的に働く力になる。式○に示すように、進行方向に一定の力がかかるように設定されている。
　パラメータは以下の式○で示すように設定されている。これは、速度ゼロ時に0.5Gがかかるようになっている。また、後述するダンピングによる減衰力と協調し、速度が30km/hになるように速度制御がかかるように設定されている。
3。4。速度を用いた制御
　前述したアクセルポテンシャルにおいて、少し説明を行ったが、提案システムでは、自車速度が30km/hになるように速度制御がはたらいている。また、ダンピングとして、X方向とY方向にそれぞれ別々の減衰力が働いており、速度を30km/hに保つ効果やレーンへ復帰するときのオーバーシュートを除去する効果がある。
3。4。1。散逸関数による蛇行動の減衰
×ダンピングによる減衰力
案：ダンピング要素の追加　散逸関数の導入（追加）
散逸関数によるふらつきの除去、改善　散逸関数による蛇行動の減衰
本文の案：車両のふらつきを押さえる為に、ダンピング要素を追加する。そのための方法として、散逸関数を定義して、ポテンシャル関数に組み込む。

　ポテンシャルフィールド法は、主にロボットが障害物を避ける制御で用いられる。そのため、車両のようにロボットと比較して高速で走行するプラントは、動特性が無視できない。動特性が無視できないと、収束が遅れやふらつきが生じる。そこで、散逸関数を定義して前述のポテンシャル関数に追加し、収束性を向上させるのがよいと考えられる。
　基本走行ポテンシャルと歩行者ポテンシャル、アクセルポテンシャルだけでは、速度は無限まで加速されてしまう。その上、収束性が悪いことにより、歩行者を追い越した後、レーンに復帰して基本走行に戻る際に、オーバーシュートが発生し、その後しばらく蛇行動がみられるなど、車両挙動に課題が存在した。そこで、ダンピングによる減衰力を導入することで、これらの課題の解決を試みた。すると、図○に示すように、速度が30km/hに収束し、オーバーシュートと蛇行動が除去された。
　ダンピングによる減衰力は、式○、式○に示すように設定されている。各パラメータについては、以下のように求める。
　X方向の減衰係数CXは、アクセルポテンシャルと協調し、速度が30km/hになるように制御されている。当然アクセルポテンシャルの設定加速度を0.5Gよりも大きくする事で、より速度が30km/hに保たれるようになるが、そうなると、仮に減速して速度がゼロになってしまったときに大きな加速度がかかってしまうため、0.5Gより大きくは設定しない。
　Y方向の減衰係数CYは、減衰比が1になるとき、オーバーシュートせずに収束することを利用して設定する。また、このパラメータは、基本走行ポテンシャルが決定されると一意に定まる。そのため、後述するシミュレーションで、シミュレーション条件の一つである道幅Wrが決定すると、自ずと値が求まる。以下、具体的な導出方法を述べる。
　まず、式○に示すように、基本走行ポテンシャルの関数が最小になるY方向の位置Ycpを求める。
		式
　次に、式○に示すように、基本走行ポテンシャルのポテンシャル関数をＹで1階微分したものにマイナスをかけ、基本走行ポテンシャルが自車に与える仮想的な力を求める。
		式
　さらに、式○に示すように、力をＹで1階偏微分する。
		式
　そして、式○に示すように、式○(↑)のＹがＹｃｐのときの値を、等価バネ定数ｋとする。
		式
　このときの臨界減衰係数ＣｃをＹ方向の減衰係数とする。なお、臨界減衰係数とは、減衰比が1であることから求まる値である。
　すると、Ｙ方向の減衰力は以下の式○のようになる。
		式
3。4。2。速度制御の検証
　散逸関数を定義し、ダンピング要素をポテンシャル関数に追加するのと共に、目標速度への追従を設定する速度制御を追加している。そこで、初期速度を以下のように設定し、そのときの速度追従性を検証した。
　初速度は、0,5,10,15,20,25,29km/hとした。

ー以下、それぞれの初速度のときの追従について記載するー

　以上により、十分な速度追従性であると考える。

　歩行者ポテンシャルを入れたときの速度追従性についても、後述する「今後の課題」で述べたい。なぜなら、歩行者ポテンシャル単体で加速を行う為、速度がオーバーシュートすることがある。

3。4。3。レーンへ復帰時のオーバーシュート、蛇行動の改善の検証
　散逸関数を追加し、ダンピング要素をポテンシャル関数に追加すると、レーン復帰時のオーバーシュート、蛇行動の改善がみられた。以下の図○に、ポテンシャル関数に散逸関数を追加した前後での、オーバーシュートと、蛇行動の変化を示す。また、表○に追加前後でのオーバーシュートと蛇行動の値を載せる。

図○　散逸関数追加前

図○　散逸関数追加後

　以上の図表から、オーバーシュートと蛇行動の改善が確認された。

　
4。シミュレーションによる評価
4。1。シミュレーションの目的
　本論文では、ポテンシャルフィールド法を用いて、車両の運動を制御する。しかし、ポテンシャルフィールド法による車両制御手法は、車両位置に応じて仮想的な力を与えるという制御の性質上、元より安全を保証するものではない。そのため、提案手法が安全かどうかを、提案手法を適用した車両を走らせ、その結果から安全を確かめる検証を行う必要がある。この検証二は、歩行者との衝突や道路境界からの逸脱を確認する必要があるが、実車による実験は危険を伴うため、実施が困難であり、現実的ではない。したがって、本論文では、図○に示したような歩行者追い越し場面を想定した車両シミュレーションを行う。そして、シミュレーション結果から、提案システムによる運転挙動が、安全の確保、交通の円滑さ、挙動の現実性として、十分妥当なものかを評価する。
　追い越し場面において、歩行者速度Ｖｐ、道幅Ｗｒ、歩行者初期Ｙ位置Ｙｐを道路条件と定義する。このとき、表○に示すように、道路条件を各条件を変化させて、全ての組み合わせに対して、シミュレーションを行い、評価基準を満たすかを確かめる。
4。2。検証内容と判定のアルゴリズム
　本論文において、提案する車両制御手法による車両挙動を検証する際の評価基準を以下の表○に示す。

		表○　車両の評価基準

以下、これらの評価基準と、それぞれの評価の判定に用いたアルゴリズムについて、説明する。

4。2。1。安全の確保の評価：最高安全速度を順守する
卒論に同じ
4。2。2。安全の確保の評価：歩行者と衝突しない
卒論と同じ
4。2。3。安全の確保の評価：道路境界より逸脱しない
卒論と同じ
4。2。4。円滑さの向上の評価：先行研究より追い越し時間が短い
　提案システムと先行研究の「自動で減速するシステム」での追い越し時間を比較した。まず、追い越し時間を定義する。
　以下の図○に示すように、本システムを搭載した車両と先行研究のシステムを搭載した車両を走行させる。先行研究のシステムにおいて、歩行者を追い越し後、速度が30km/hに復帰したときのスタート地点からの時間をTg、距離をDtgとする。本システムにおいて、Tgのときの距離をDegとする。このとき、以下の式○のように、追い越し時間の差として、車頭時間(Time Headway)を定義する。
	式　Thw = (Deg - Dtg)/30km/h
　網羅したすべての道路条件２００通りについて、車頭時間を表○に示す。
	表　すべての条件における車頭時間
　この結果をみると、次のいくつかのパターンに分けられる
・大きいマイナス
・ほぼゼロのマイナス
・ややゼロプラス
・おおきくプラス

※→車頭時間のGraphResultでの出力グラフを、上述した４つのパターンで色塗り分けるのがいいのではないだろうか？そうすると、かならずしも悪い場合ではないということがわかるのではないだろうか？あと、色塗りを明るい色にするようにしたらどうか？
[1.0, 1.0, 0.0]*ratio + [0.0, 0.0, 1.0]
青と水色で構成される

　各場合の車両挙動をみてみると、以下の図○のようになる。
・大きいマイナス
　提案システムは、Ｘが0m地点より前で、減速し、車両速度がほとんどゼロになっている。それに対して、先行研究のシステムは、直進するため、確実に追い越すことができている。そのため、大きく差ができている
・ほぼゼロのマイナス
　最高安全速度が30km/hを下回らない場合。先行研究のシステムは、減速せず直進できるため、理論上、もっとも早く追い越しができる。それに対して、提案システムは、ポテンシャルフィールドの影響により減速や右によけるような挙動になり、追い越しによけいな時間がかかる。しかし、その差はわずかであるため、ほとんどゼロでマイナスの車頭時間になる。
・ややゼロプラス
　先行研究のシステムは、大きく減速せざるを得ないが、提案システムは右によけることにより減速を減らすことができる。そのため、追い越し時間が先行研究よりも短くなっている。ただし、最高安全速度ギリギリで下回らず、大きく下回っているので、先行研究よりも早く追い越せているが、その差はおおきくない。
・おおきくプラス
　先行研究のシステムでは、歩行者が進路上にいるため、追い越しができない。その為、差がおおきくなった。
　
　以上より、提案システムは、全場面で、円滑さが向上したとはいえない。しかし、一部の場面では、円滑さが向上した。

4。2。6。挙動の安定性の評価：加速度の絶対値が0.5G以下

4。2。7。挙動の安定性の評価：ハンドル各速度の絶対値が240deg/s以下

4。2。8。挙動の安定性の評価：ハンドル角度の絶対値が180deg以下

4。3。シミュレーションにおいて使用する車両モデル
　本論文では、シミュレーションにより、提案手法を評価する。その際に用いる車両モデルは、車両速度によって使い分けている。低速の場合は幾何学的運動モデル、高速の場合には等価二輪モデルを利用している。卒論時は等価二輪モデルのみを用いていたため、低速時に値が発散し、結果が正しく得られなかったが、今回、低速時に幾何的運動モデルを導入したことにより、この問題が解決した。
4。3。1。低速時の幾何的運動モデル（※）ｐ８
　移動速度が低い移動ロボットや搬送台車の運動を扱う場合に、あるいは走行速度がきわめて低い自動車などの奇跡を扱い場合には、基本的に車輪の滑りが無視でき、幾何学的な取り扱いをすることができる（※）。
　車体を静的に支えるには最低３個の車輪が必要である。高速時には等価的に二輪として考えるため、低速時にも同様に考えることとする。そこで、操舵輪が１個で、固定輪が２個の場合を考える。この場合、車体の運動は操舵角度によって決定されるものとし、駆動輪の回転は従属的に決まるものとする。
　図○は、操舵輪が１個と固定輪が２個の場合の、車体の瞬間回転中心を示している。図中には、各車輪が横滑りをしないものとして車輪の向きと同じ向きに速度ベクトルを描いてある。各車輪の速度ベクトルと直角方向に引いた直線上に車体の瞬間回転中心が存在している。操舵車輪が１個の場合二は、その操舵角のみによって瞬間回転中心が決定される。そこで２個の固定輪の中央の点Pにおける移動速度をVとして、車体に固定した移動座標における速度成分を求めると、以下のようになる。
		式　u=V, v=0, gamma = V/l*tan(delta)
　
4。3。2。高速時の等価二輪モデル（※）

4。4。シミュレーション結果
　本節では、前節で述べた評価基準に対する検証と一定区間の通過時間に対する検証を以下に示すシミュレーションの結果に対して行う。図○に示す想定場面におけるポテンシャルパラメータは、表○に示す値に定めた。
　道路条件は、以下の表○に示すような範囲内で網羅的に設定する。網羅した条件は200通りである。
　網羅した道路条件において、各評価基準の判定結果を以下の図○〜○に示す。
		図を複数
　この結果より、青色で塗られた範囲では、提案手法は安全であり、円滑さが向上し、挙動が現実的であることが示された。
　それでは、今回網羅した200通りの中からパターンごとにいくつか抜粋する。
4。4。1。○な場合



4。5。結果の考察と今後の課題

　交通の円滑さ向上について
→もともと、露木理論でも早く追い越せる場合は、円滑さがこれ以上向上することはないので、同様ならばよしとする。というか、理論上、ポテンシャルの方が遅くなることは十分明らかである（露木システムが減速しないのに、提案手法が減速しないですむとは限らない

そもそも評価方法があまりよくない（考えられていない、評価自体が適切とは言い難い
というのも、単に車頭時間を比べているだけである。

円滑さ向上だけでなく、通過できなかった場面を通過できるようになったことも言える。（目的にはないが、プラスの効果がでたのならばよいと言える。

故に、露木システムでは適用できない場面でも、提案システムであれば、適用できる、ということが言えれば、それは、既存のシステムに比べ、性能が向上したと言えよう。

また、今後の課題がはっきりしていることほど、いいことはない。
次になにをすればいいのかわかるというのは今後の研究としては、重要である。



5。結言
　本論文では、安全と交通の円滑さの確保のために、また、
・研究背景
・謝辞



・質疑応答
